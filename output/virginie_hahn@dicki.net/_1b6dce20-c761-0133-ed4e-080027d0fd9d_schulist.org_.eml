Date: Tue, 08 Mar 2016 12:23:22 +0000
From: Pietro Bernhard <paula.parisian@schulist.org>
To: virginie_hahn@dicki.net
Message-ID: <1b6dce20-c761-0133-ed4e-080027d0fd9d@schulist.org>
Subject: Can&#39;t get list filled from a promise and use it in html - aurelia
Mime-Version: 1.0
Content-Type: multipart/alternative;
 boundary="--==_mimepart_56ded611c93b1_118541a29ae91298";
 charset=UTF-8
Content-Transfer-Encoding: 7bit


----==_mimepart_56ded611c93b1_118541a29ae91298
Content-Type: text/plain;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

I can't get the finalList filled to use in my html file, it wil run the code to fill it before the promise all code. I need to use this array in my html document so it has to be a this.variable I am using Aurelia.

activate() {
var repoList = [];
var repos = this.http.fetch({Link to github api})
.then(response => response.json())
.then(repos => this.repos = repos);
var trello = new Trello;
trello.getBoards().then(boardList => this.boards = boardList);
var boards = trello.getBoards();
//add github repo to the associated trello board (works)
Promise.all([boards, repos]).then(function(values) {
  var count = 0;
  for (var i in values[0]) {
    for (var a in values[1]) {
      if (values[1][a].hasOwnProperty("name"))
      {
        var repo = values[1][a].name.toLowerCase();
        var board = values[0][i]['name'].toLowerCase();
        repoList[count] = repo;
        count++;
        if (repo == board) 
        {
          console.log(repo + " " + board)
        };

      }
    };
  };      
});

//this list is always empty (The problem)
this.finalList = repoList;
this.title = "Trello Boards";
}
}

----==_mimepart_56ded611c93b1_118541a29ae91298
Content-Type: text/html;
 charset=UTF-8
Content-Transfer-Encoding: 7bit

<p>I can't get the finalList filled to use in my html file, it wil run the code to fill it before the promise all code. I need to use this array in my html document so it has to be a this.variable I am using Aurelia.</p>

<pre class="lang-js prettyprint-override"><code>activate() {
var repoList = [];
var repos = this.http.fetch({Link to github api})
.then(response =&gt; response.json())
.then(repos =&gt; this.repos = repos);
var trello = new Trello;
trello.getBoards().then(boardList =&gt; this.boards = boardList);
var boards = trello.getBoards();
//add github repo to the associated trello board (works)
Promise.all([boards, repos]).then(function(values) {
  var count = 0;
  for (var i in values[0]) {
    for (var a in values[1]) {
      if (values[1][a].hasOwnProperty("name"))
      {
        var repo = values[1][a].name.toLowerCase();
        var board = values[0][i]['name'].toLowerCase();
        repoList[count] = repo;
        count++;
        if (repo == board) 
        {
          console.log(repo + " " + board)
        };

      }
    };
  };      
});

//this list is always empty (The problem)
this.finalList = repoList;
this.title = "Trello Boards";
}
}
</code></pre>
----==_mimepart_56ded611c93b1_118541a29ae91298--
